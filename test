import sbe

# Load the schema
with open('your-schema.xml', 'r') as f:
    schema = sbe.Schema.parse(f)

# Define the input message
input_message = {
    'name': 'NewOrderSingle',
    'fields': {
        'SendingTime': 1623157199000000000,
        'ClOrdID': 'ORDER001',
        'OptionsSecurityID': 'OPT123',
        'Side': 'Buy',
        'OrderQty': 100,
        'OrdType': 'Limit',
        'Price': 123.45,
        'TimeInForce': 'Day'
    }
}

# Encode the input message
encoded = schema.encode(input_message)

# Save the encoded message to a file
with open('encoded.sbe', 'wb') as f:
    f.write(encoded)

# Read the encoded message from the file
with open('encoded.sbe', 'rb') as f:
    encoded_data = f.read()

# Decode the encoded message
decoded = schema.decode(encoded_data)

# Access the decoded fields
name = decoded.name
value = decoded.value

# Print the original input message
print("Input Message:")
print(input_message)

# Print the encoded message
print("Encoded Message:")
print(encoded)

# Print the decoded message
print("Decoded Message:")
print(name)
print(value)
