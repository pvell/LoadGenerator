import pandas as pd
import sqlite3

# Connect to the SQLite database
conn = sqlite3.connect('trades.db')

# Query the data from the grouped_trades_new table
query = "SELECT * FROM grouped_trades_new"

# Fetch the data into a pandas DataFrame
grouped_trade_data_frame = pd.read_sql_query(query, conn)

# Close the database connection
conn.close()

# Dump the DataFrame into an Excel file
output_file = 'grouped_trades_new.xlsx'
grouped_trade_data_frame.to_excel(output_file, index=False)

print(f"Data from grouped_trades_new has been successfully dumped to '{output_file}'.")
