#!/bin/bash

# Define your SFTP server information
sftp_server="user@sftp_server_ip_or_hostname"
sftp_user="your_username"
sftp_password="your_password"

# Calculate the previous day in MM-DD format
previous_date=$(date -d "yesterday" +"%m-%d")

# Construct the remote directory path on the SFTP server
remote_directory="/path/to/remote/files"

# Construct the source file pattern to match the files with the previous day's MM-DD.csv pattern
file_pattern="$previous_date.csv"

# Construct the destination directory on your local machine
local_directory="/path/to/local/folder"

# Use sftp to retrieve the files from the SFTP server
sftp $sftp_user@$sftp_server:$remote_directory/$file_pattern $local_directory/

# Check the exit status of sftp
if [ $? -eq 0 ]; then
    echo "Files matching $file_pattern retrieved successfully."
else
    echo "Error: Files matching $file_pattern retrieval failed."
fi
