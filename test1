#!/bin/bash


YEAR=$(date +"%Y")


for FILE in *; do
    # Check if it is a regular file
    if [ -f "$FILE" ]; then
        
        MONTH=$(date -r "$FILE" +"%m")
        YEAR_FILE=$(date -r "$FILE" +"%Y")

       
        if [ "$YEAR_FILE" = "$YEAR" ]; then
            # Create the month folder if it doesn't exist
            MONTH_FOLDER="${YEAR}-${MONTH}"
            mkdir -p "$MONTH_FOLDER"

           
            mv "$FILE" "$MONTH_FOLDER/"
        fi
    fi
done


for FOLDER in "${YEAR}-"??; do
    # Check if it is a directory
    if [ -d "$FOLDER" ]; then
        # Create a compressed archive
        tar -czf "${FOLDER}.tar.gz" "$FOLDER"
    fi
done

echo "Compression completed."
